/* ---------------------------------------------------- */
/*  Generated by Enterprise Architect Version 13.5 		*/
/*  Created On : 08-feb.-2023 11:49:44 a. m. 				*/
/*  DBMS       : Oracle 						*/
/* ---------------------------------------------------- */

/* Drop Triggers, Sequences for Autonumber Columns */

DECLARE 
  C NUMBER; 
BEGIN 
SELECT COUNT(*) INTO C 
FROM ALL_TRIGGERS 
  WHERE OWNER = '' 
  AND TRIGGER_NAME = 'TRG_APPLICATION_FINANTIAL_COSTS_AFC_ID'; 
  IF (C > 0) THEN 
    EXECUTE IMMEDIATE 'DROP TRIGGER "TRG_APPLICATION_FINANTIAL_COSTS_AFC_ID"'; 
END IF; 
END; 

;

DECLARE 
  C NUMBER; 
BEGIN 
SELECT COUNT(*) INTO C 
FROM ALL_SEQUENCES 
  WHERE SEQUENCE_OWNER = '' 
  AND SEQUENCE_NAME = 'SEQ_APPLICATION_FINANTIAL_COSTS_AFC_ID'; 
  IF (C > 0) THEN 
    EXECUTE IMMEDIATE 'DROP SEQUENCE "SEQ_APPLICATION_FINANTIAL_COSTS_AFC_ID"'; 
END IF; 
END; 

;

/* Drop Tables */

begin
	EXECUTE IMMEDIATE 'DROP TABLE   "APPLICATION_FINANTIAL_COSTS" CASCADE CONSTRAINTS';
	EXCEPTION WHEN OTHERS THEN NULL;
end;  
/

/* Create Tables */

CREATE TABLE  "APPLICATION_FINANTIAL_COSTS"
(
	"AFC_ID" NUMBER(8) NOT NULL,    -- Identificador de la tabla
	"CREATED_AT" DATE NULL,
	"UPDATED_AT" DATE NULL,
	"FINANCING_TYPE" VARCHAR2(20) NOT NULL,
	"RECOMMENDED_TEMR_IN_MONTHS" NUMBER(10) NOT NULL,
	"MONETARY_CORRECTION" NUMBER(1) NOT NULL,
	"NOMINAR_INTEREST_RATE" NUMBER(8,2) NOT NULL,
	"ANNUAL_EFFECTIVE_INTEREST_RATE" NUMBER(8,2) NOT NULL,
	"MONTLY_RATE" NUMBER(8,2) NOT NULL,
	"UVR_CONSULT_DAY" NUMBER(8,2) NOT NULL,
	"UVR_ANNUAL_PERCENTAGE_CHANGE" NUMBER(8,2) NOT NULL,
	"UVR_MONTLY_PERCENTAGE_CHANGE" NUMBER(8,2) NOT NULL,
	"SPREAD" NUMBER(8,2) NOT NULL,
	"USER_ID" NUMBER(8) NOT NULL,
	"APPL_ID" NUMBER(8) NOT NULL
)
TABLESPACE	TRSC_TBS02
;

/* Create Comments, Sequences and Triggers for Autonumber Columns */

COMMENT ON COLUMN  "APPLICATION_FINANTIAL_COSTS"."AFC_ID" IS 'Identificador de la tabla'
;

CREATE SEQUENCE "SEQ_APPLICATION_FINANTIAL_COSTS_AFC_ID" 
	INCREMENT BY 1 
	START WITH 1 
	NOMAXVALUE 
	MINVALUE  1 
	NOCYCLE 
	NOCACHE 
	NOORDER
;

CREATE OR REPLACE TRIGGER "TRG_APPLICATION_FINANTIAL_COSTS_AFC_ID" 
	BEFORE INSERT 
	ON "APPLICATION_FINANTIAL_COSTS" 
	FOR EACH ROW 
	BEGIN 
		SELECT "SEQ_APPLICATION_FINANTIAL_COSTS_AFC_ID".NEXTVAL 
		INTO :NEW."AFC_ID" 
		FROM DUAL; 
	END;
;
/


/* Create Primary Keys, Indexes, Uniques, Checks, Triggers */

ALTER TABLE  "APPLICATION_FINANTIAL_COSTS" 
 ADD CONSTRAINT "PK_APPLICATION_FINANT_01"
	PRIMARY KEY ("AFC_ID") 
 USING INDEX
;

CREATE INDEX "IXFK_APPLICATION__APPLICA01"   
 ON  "APPLICATION_FINANTIAL_COSTS" ("APPL_ID") 
;

CREATE INDEX "IXFK_APPLICATION_FINANT_U01"   
 ON  "APPLICATION_FINANTIAL_COSTS" ("USER_ID") 
;

/* Create Foreign Key Constraints */

ALTER TABLE  "APPLICATION_FINANTIAL_COSTS" 
 ADD CONSTRAINT "FK_APPLICATION__APPLICATION_03"
	FOREIGN KEY ("APPL_ID") REFERENCES  "APPLICATIONS" ("APPL_ID")
;

ALTER TABLE  "APPLICATION_FINANTIAL_COSTS" 
 ADD CONSTRAINT "FK_APPLICATION_FINANT_USERS_01"
	FOREIGN KEY ("USER_ID") REFERENCES  "USERS" ("USER_ID")
;
